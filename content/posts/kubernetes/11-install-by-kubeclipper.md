---
title: "Kubernetesæ•™ç¨‹(åä¸€)---ä½¿ç”¨ KubeClipper é€šè¿‡ä¸€æ¡å‘½ä»¤å¿«é€Ÿåˆ›å»º k8s é›†ç¾¤"
description: "ä½¿ç”¨ KubeClipper é€šè¿‡ä¸€æ¡å‘½ä»¤å¿«é€Ÿåˆ›å»º k8s é›†ç¾¤"
date: 2022-08-20
draft: false
categories: ["Kubernetes"]
tags: ["Kubernetes"]
---

æœ¬æ–‡ä¸»è¦è®°å½•äº†å¦‚ä½•ä½¿ç”¨å¼€æºé¡¹ç›® KubeClipper é€šè¿‡ä¸€æ¡å‘½ä»¤å¿«é€Ÿåˆ›å»º k8s é›†ç¾¤ã€‚

<!--more-->

ä¹‹å‰å†™äº†ä¸€ç¯‡ä½¿ç”¨ kubeadm åˆ›å»ºé›†ç¾¤çš„æ–‡ç« ï¼š [Kubernetesæ•™ç¨‹(ä¸€)---ä½¿ç”¨ kubeadm åˆ›å»º k8s é›†ç¾¤(containerd)](https://www.lixueduan.com/posts/kubernetes/01-install/)ï¼Œæ•´ä¸ªæµç¨‹ä¸‹æ¥å…¶å®è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œä½“éªŒå¹¶ä¸æ˜¯å¤ªå¥½ï¼Œä»Šå¤©ç»™å¤§å®¶æ¨èä¸€ä¸ªä¼˜ç§€çš„å¼€æºé¡¹ç›®ï¼š[KubeClipper ](https://github.com/kubeclipper-labs/kubeclipper)ã€‚



## 1. ä»€ä¹ˆæ˜¯ KubeClipper

KubeClipper æ—¨åœ¨æä¾›æ˜“ä½¿ç”¨ã€æ˜“è¿ç»´ã€æè½»é‡ã€ç”Ÿäº§çº§çš„ Kubernetes å¤šé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†æœåŠ¡ï¼Œè®©è¿ç»´å·¥ç¨‹å¸ˆä»ç¹å¤çš„é…ç½®å’Œæ™¦æ¶©çš„å‘½ä»¤è¡Œä¸­è§£æ”¾å‡ºæ¥ï¼Œå®ç°ä¸€ç«™å¼ç®¡ç†è·¨åŒºåŸŸã€è·¨åŸºç¡€è®¾æ–½çš„å¤š K8S é›†ç¾¤ã€‚

KubeClipper çš„ 3ä¸ªä¼˜åŠ¿ï¼š

* 1ï¼‰æ˜“ä½¿ç”¨ï¼šå›¾å½¢åŒ–é¡µé¢
  * æä¾› Web æ§åˆ¶å°ï¼Œé€šè¿‡ç‚¹ç‚¹é¼ æ ‡å³å¯åˆ›å»ºä¸€ä¸ª k8s é›†ç¾¤
* 2ï¼‰æè½»é‡ï¼šæ¶æ„ç®€å•ï¼Œå°‘ä¾èµ–
  * ä¸ä¾èµ– ansibleï¼Œä½¿ç”¨æ–¹ä¾¿
* 3ï¼‰ç”Ÿäº§çº§ï¼šæ˜“ç”¨æ€§å’Œä¸“ä¸šæ€§å…¼é¡¾
  * æä¾›åœ¨çº¿ã€ç¦»çº¿ã€ä»£ç†æ–¹å¼éƒ¨ç½²ä»¥åŠå¤šç‰ˆæœ¬ K8Sã€CRIã€CNI é€‰æ‹©
  * æä¾›äº†ç¦»çº¿éƒ¨ç½²æ–¹å¼å¯¹**å›½å†…ç”¨æˆ·æä¸ºå‹å¥½**ï¼Œæ¯•ç«Ÿç½‘ç»œæ‰æ˜¯å›½å†…ç”¨æˆ·è£… k8s çš„ä¸€å¤§éš¾é¢˜ã€‚

å…³äºè¯¥é¡¹ç›®çš„æ›´å¤šä¿¡æ¯è§ï¼š[Github Repo](https://github.com/kubeclipper-labs/kubeclipper) ä»¥åŠå®˜æ–¹çš„è¿™ç¯‡ä»‹ç»æ–‡ç« ï¼š[KubeClipperâ€”â€”è½»é‡ä¾¿æ·çš„ Kubernetes å¤šé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†å·¥å…·](https://mp.weixin.qq.com/s/RVUB5Pw6-A5zZAQktl8AcQ)

ä¸€å¥è¯æ¦‚æ‹¬ï¼š**KubeClipper æ˜¯ä¸€ä¸ªè½»é‡ä¾¿æ·çš„ Kubernetes å¤šé›†ç¾¤å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†å·¥å…·**ã€‚



## 2. å¿«é€Ÿå¼€å§‹

### å‡†å¤‡å·¥ä½œ

KubeClipper æœ¬èº«å¹¶ä¸ä¼šå ç”¨å¤ªå¤šèµ„æºï¼Œä½†æ˜¯ä¸ºäº†åç»­æ›´å¥½çš„è¿è¡Œ Kubernetes å»ºè®®ç¡¬ä»¶é…ç½®ä¸ä½äºæœ€ä½è¦æ±‚ã€‚

æ‚¨ä»…éœ€å‚è€ƒä»¥ä¸‹å¯¹æœºå™¨ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿçš„è¦æ±‚å‡†å¤‡ä¸€å°ä¸»æœºã€‚

#### ç¡¬ä»¶æ¨èé…ç½®

- ç¡®ä¿æ‚¨çš„æœºå™¨æ»¡è¶³æœ€ä½ç¡¬ä»¶è¦æ±‚ï¼šCPU >= 2 æ ¸ï¼Œå†…å­˜ >= 2GBã€‚
- æ“ä½œç³»ç»Ÿï¼šCentOS 7.x / Ubuntu 18.04 / Ubuntu 20.04ã€‚

#### èŠ‚ç‚¹è¦æ±‚

- èŠ‚ç‚¹å¿…é¡»èƒ½å¤Ÿé€šè¿‡ `SSH` è¿æ¥ã€‚
- èŠ‚ç‚¹ä¸Šå¯ä»¥ä½¿ç”¨ `sudo` / `curl` / `wget` / `tar` / `gzip`å‘½ä»¤ã€‚

> å»ºè®®æ‚¨çš„æ“ä½œç³»ç»Ÿå¤„äºå¹²å‡€çŠ¶æ€ï¼ˆä¸å®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶ï¼‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚



å®é™…ä¸Šè¿™äº›è¦æ±‚åŸºæœ¬ä¸Šä¸ç”¨ç‰¹åˆ«å¤„ç†ï¼Œéšä¾¿æ‰¾ä¸€å°æœºå™¨éƒ½æ»¡è¶³æ¡ä»¶ï¼Œæœ¬æ–‡å°±ä½¿ç”¨ä¸€å° 2C4G çš„ CentOS 7.9 æœºå™¨æ¥éƒ¨ç½²ã€‚



### å®‰è£… KubeClipper

#### ä¸‹è½½ kcctl

KubeClipper æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ğŸ”§ kcctlï¼Œæˆ‘ä»¬å…ˆå®‰è£… kcctlï¼Œå®‰è£…å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
curl -sfL https://oss.kubeclipper.io/kcctl.sh | KC_REGION=cn bash -
```

é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ:

```bash
kcctl version
```



#### å¼€å§‹å®‰è£…

ç„¶åä½¿ç”¨ kcctl å®‰è£… kubeclipperï¼Œä¸€æ¡å‘½ä»¤å³å¯,æ¨¡æ¿å¦‚ä¸‹ï¼š

```bash
kcctl deploy  [--user root] (--passwd SSH_PASSWD | --pk-file SSH_PRIVATE_KEY)
```

> åªéœ€è¦æä¾› ssh user ä»¥åŠ ssh passwd æˆ–è€… ssh ç§é’¥å³å¯åœ¨æœ¬æœºéƒ¨ç½² KubeClipperã€‚

è‹¥ä½¿ç”¨ ssh passwd æ–¹å¼åˆ™å‘½ä»¤å¦‚ä¸‹æ‰€ç¤º:

```bash
kcctl deploy --user root --passwd $SSH_PASSWD
```

ç§é’¥æ–¹å¼å¦‚ä¸‹ï¼š

```bash
kcctl deploy --user root --pk-file $SSH_PRIVATE_KEY
```

æœ¬æ–‡ä½¿ç”¨å¯†ç è¿›è¡Œéƒ¨ç½²ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
kcctl deploy --user root --passwd root
```



æ‰§è¡Œè¯¥å‘½ä»¤åï¼ŒKcctl å°†æ£€æŸ¥å®‰è£…ç¯å¢ƒï¼Œè‹¥æ»¡è¶³æ¡ä»¶å°†ä¼šè¿›å…¥å®‰è£…æµç¨‹ã€‚åœ¨æ‰“å°å‡ºå¦‚ä¸‹çš„ KubeClipper banner åå³è¡¨ç¤ºå®‰è£…å®Œæˆã€‚

```
 _   __      _          _____ _ _
| | / /     | |        /  __ \ (_)
| |/ / _   _| |__   ___| /  \/ |_ _ __  _ __   ___ _ __
|    \| | | | '_ \ / _ \ |   | | | '_ \| '_ \ / _ \ '__|
| |\  \ |_| | |_) |  __/ \__/\ | | |_) | |_) |  __/ |
\_| \_/\__,_|_.__/ \___|\____/_|_| .__/| .__/ \___|_|
                                 | |   | |
                                 |_|   |_|
```



> å®‰è£…è¿‡ç¨‹ä¸­éœ€è¦å»é˜¿é‡Œäº‘ä¸‹è½½ç¦»çº¿å®‰è£…åŒ…ï¼Œé€Ÿåº¦æœ‰ç‚¹æ…¢(åç»­ä¼šä¼˜åŒ–)ï¼Œéœ€è¦å¤§æ¦‚ 3åˆ†é’Ÿæ—¶é—´ã€‚



### ç™»å½•æ§åˆ¶å°

å®‰è£…å®Œæˆåï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® `http://$IP` å³å¯è¿›å…¥ KubeClipper æ§åˆ¶å°ã€‚

![](../../../img/kubernetes/kubeclipper/kc-console-login.png)

æ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤å¸å·å¯†ç  `admin / Thinkbig1` è¿›è¡Œç™»å½•ã€‚

> æ‚¨å¯èƒ½éœ€è¦é…ç½®ç«¯å£è½¬å‘è§„åˆ™å¹¶åœ¨å®‰å…¨ç»„ä¸­å¼€æ”¾ç«¯å£ï¼Œä»¥ä¾¿å¤–éƒ¨ç”¨æˆ·è®¿é—®æ§åˆ¶å°ã€‚

> æ–‡ä¸­æ‰€æœ‰æ“ä½œå‡é€šè¿‡å‘½ä»¤è¡Œå·¥å…·å®Œæˆï¼Œè‡³äºæ§åˆ¶å°ç›¸å…³åŠŸèƒ½åˆ™ç”±å¤§å®¶è‡ªè¡Œæ¢ç´¢äº†~



###  å®‰è£… K8S é›†ç¾¤

éƒ¨ç½²æˆåŠŸåå¯ä»¥ä½¿ç”¨ **kcctl å·¥å…·**æˆ–è€…é€šè¿‡**æ§åˆ¶å°**åˆ›å»º k8s é›†ç¾¤ï¼Œ è¿™é‡Œå’±ä»¬ä½¿ç”¨ kcctl å·¥å…·è¿›è¡Œåˆ›å»ºã€‚

> å‘½ä»¤è¡Œï¼Œç¨‹åºçŒ¿æœ€åçš„å€”å¼ºã€‚

é¦–å…ˆä½¿ç”¨é»˜è®¤è´¦å·å¯†ç è¿›è¡Œç™»å½•è·å– tokenï¼Œä¾¿äºåç»­ kcctl å’Œ kc-server è¿›è¡Œäº¤äº’ã€‚

```bash
kcctl login -H http://localhost -u admin -p Thinkbig1
```

æŸ¥çœ‹å½“å‰ agent èŠ‚ç‚¹

```bash
[root@iZbp12pyvyollw222dekjmZ ~]# kcctl get node
+--------------------------------------+-------------------------+---------+----------------+-------------+-----+--------+
|                  ID                  |        HOSTNAME         | REGION  |       IP       |   OS/ARCH   | CPU |  MEM   |
+--------------------------------------+-------------------------+---------+----------------+-------------+-----+--------+
| ca22ddb8-5a61-4ca3-87bd-91fa71080cb7 | kc-1 | default | 192.168.10.217 | linux/amd64 |   2 | 3646Mi |
+--------------------------------------+-------------------------+---------+----------------+-------------+-----+--------+

```

ç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»º k8s é›†ç¾¤:

```bash
# å…¶ä¸­ IP ä¸ºä¸Šä¸€æ­¥ä¸­çš„ kc-1 èŠ‚ç‚¹ IP
kcctl create cluster --name demo --master 192.168.10.217 --untaint-master
```

å¤§æ¦‚ 3 åˆ†é’Ÿå·¦å³å³å¯å®Œæˆé›†ç¾¤åˆ›å»º,ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çŠ¶æ€

```bash
kcctl get cluster -o yaml|grep status -A5
```

> ä¹Ÿå¯ä»¥è¿›å…¥æ§åˆ¶å°æŸ¥çœ‹**å®æ—¶æ—¥å¿—**ã€‚

è¿›å…¥ Running çŠ¶æ€å³è¡¨ç¤ºé›†ç¾¤å®‰è£…å®Œæˆ,æ‚¨å¯ä»¥ä½¿ç”¨ `kubectl get cs` å‘½ä»¤æ¥æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶å†µã€‚

```bash
$ kubectl get cs
NAME                 STATUS    MESSAGE                         ERROR
scheduler            Healthy   ok                              
controller-manager   Healthy   ok                              
etcd-0               Healthy   {"health":"true","reason":""} 
```



è‡³æ­¤ï¼Œæˆ‘ä»¬çš„å•èŠ‚ç‚¹ç‰ˆæœ¬å°±ç®—æ˜¯ç»“æŸäº†ï¼Œç›¸æ¯”ä¹‹ä¸‹ç¡®å®æ¯”ä½¿ç”¨åŸç”Ÿ kubeadm ä½“éªŒå¥½å¤šäº†ã€‚



## 3. å¤šèŠ‚ç‚¹ç‰ˆæœ¬

ä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œk8s é›†ç¾¤è‡³å°‘éœ€è¦ 3ä¸ª master èŠ‚ç‚¹ï¼ŒåŒæ—¶ kubeclipper ä½¿ç”¨ etcd ä½œä¸ºåç«¯å­˜å‚¨ï¼Œä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œä¹Ÿå»ºè®®è‡³å°‘ä½¿ç”¨ 3 èŠ‚ç‚¹åŠä»¥ä¸Šæ¥éƒ¨ç½²ã€‚

>  åŒæ—¶ç”Ÿäº§ç¯å¢ƒä¸€èˆ¬å»ºè®® kubeclipper server èŠ‚ç‚¹å•ç‹¬å­˜åœ¨ï¼Œä¸å»ºè®®å°† server èŠ‚ç‚¹åŒæ—¶ä½œä¸º agent èŠ‚ç‚¹ä½¿ç”¨ã€‚

èŠ‚ç‚¹è§„åˆ’å¦‚ä¸‹ï¼š

* 3 å° ä½œä¸º kubeclipper server éƒ¨ç½²ä½¿ç”¨
* 5 å° ä½œä¸º kubeclipper agent èŠ‚ç‚¹ï¼Œéƒ¨ç½² k8s ä½¿ç”¨ã€‚

> èµ„æºæœ‰é™ï¼Œä¾æ—§æ˜¯ 2C4G çš„ CentOS 7.9 æœºå™¨



### å®‰è£… KubeClipper

åŒæ ·çš„ï¼Œè¿˜æ˜¯éœ€è¦å…ˆå®‰è£… kcctl å·¥å…·ï¼Œå®‰è£…æ–¹å¼å’Œä¹‹å‰æ˜¯ä¸€æ ·çš„ï¼Œä¸€æ¡å‘½ä»¤æå®šï¼š

> kcctl å·¥å…·åªéœ€è¦åœ¨ä»»æ„ä¸€å°èŠ‚ç‚¹ä¸Šå®‰è£…å³å¯ï¼Œåªè¦èƒ½ä½¿ç”¨ ssh è®¿é—®å…¶ä»–èŠ‚ç‚¹å³å¯ã€‚
>
> ä¸ºäº†å’Œæœ¬æ•™ç¨‹ä¿æŒä¸€è‡´ï¼Œå»ºè®®åœ¨å…¶ä¸­çš„ä¸€å° server èŠ‚ç‚¹ä¸Šå®‰è£…ã€‚

```bash
curl -sfL https://oss.kubeclipper.io/kcctl.sh | KC_REGION=cn bash -
```



æ¥ç€ä½¿ç”¨ kcctl éƒ¨ç½² KubeClipperï¼Œå…¶æ¨¡æ¿å¦‚ä¸‹æ‰€ç¤ºï¼š

```bash
kcctl deploy  [--user root] (--passwd SSH_PASSWD | --pk-file SSH_PRIVATE_KEY) (--server SERVER_NODES) (--agent AGENT_NODES)
```

> éœ€è¦æ‰‹åŠ¨æŒ‡å®š server èŠ‚ç‚¹ä»¥åŠ agent èŠ‚ç‚¹ã€‚

è‹¥ä½¿ç”¨ å¯†ç  æ–¹å¼åˆ™å‘½ä»¤å¦‚ä¸‹æ‰€ç¤º:

```bash
kcctl deploy --user root --passwd $SSH_PASSWD --server SERVER_NODES --agent AGENT_NODES
```

ç§é’¥ æ–¹å¼å¦‚ä¸‹ï¼š

```bash
kcctl deploy --user root --pk-file $SSH_PRIVATE_KEY --server SERVER_NODES --agent AGENT_NODES
```

æœ¬æ•™ç¨‹ä½¿ç”¨ å¯†ç  æ–¹å¼è¿›è¡Œéƒ¨ç½²ï¼Œå…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
kcctl deploy --server 192.168.10.217,192.168.10.196,192.168.10.136 --agent 192.168.10.58,192.168.10.225,192.168.10.19,192.168.10.27,192.168.10.4 --passwd root --pkg https://oss.kubeclipper.io/release/v1.1.0/kc-amd64.tar.gz
```

> 3 ä¸ª server èŠ‚ç‚¹ï¼Œ5 ä¸ª agent èŠ‚ç‚¹ï¼Œå¤šä¸ª IP ä¹‹é—´ä½¿ç”¨é€—å·`,`åˆ†éš”

åŒæ ·çš„ï¼Œåœ¨æ‰“å°å‡ºå¦‚ä¸‹çš„ KubeClipper banner åå³è¡¨ç¤ºå®‰è£…å®Œæˆã€‚

```text
 _   __      _          _____ _ _
| | / /     | |        /  __ \ (_)
| |/ / _   _| |__   ___| /  \/ |_ _ __  _ __   ___ _ __
|    \| | | | '_ \ / _ \ |   | | | '_ \| '_ \ / _ \ '__|
| |\  \ |_| | |_) |  __/ \__/\ | | |_) | |_) |  __/ |
\_| \_/\__,_|_.__/ \___|\____/_|_| .__/| .__/ \___|_|
                                 | |   | |
                                 |_|   |_|
```



### åˆ›å»ºé«˜å¯ç”¨ K8S é›†ç¾¤

è¿™é‡Œæˆ‘ä»¬åŒæ ·ä½¿ç”¨ kcctl å·¥å…·ï¼Œé€šè¿‡å‘½ä»¤è¡Œæ–¹å¼è¿›è¡Œåˆ›å»ºã€‚è€è§„çŸ©ï¼Œä½¿ç”¨é»˜è®¤è´¦å·å¯†ç è¿›è¡Œç™»å½•ï¼š

```bash
kcctl login -H http://localhost -u admin -p Thinkbig1
```

ç„¶åæŸ¥çœ‹ä¸€ä¸‹å½“å‰çš„ agent èŠ‚ç‚¹ä¿¡æ¯ï¼š

```bash
[root@server-1 ~]# kcctl get node
+--------------------------------------+----------+---------+----------------+-------------+-----+--------+
|                  ID                  | HOSTNAME | REGION  |       IP       |   OS/ARCH   | CPU |  MEM   |
+--------------------------------------+----------+---------+----------------+-------------+-----+--------+
| ba6a5399-387f-4abd-a1b8-585e0094bf25 | agent-5  | default | 192.168.10.4   | linux/amd64 |   2 | 3938Mi |
| 2c3bb128-0081-4efa-aced-9d5560a5aa63 | agent-4  | default | 192.168.10.27  | linux/amd64 |   2 | 3938Mi |
| e5a79dbe-d872-4118-90f5-5d86bbf34392 | agent-3  | default | 192.168.10.19  | linux/amd64 |   2 | 3938Mi |
| 74aed462-221c-4053-a897-e2166f805285 | agent-2  | default | 192.168.10.225 | linux/amd64 |   2 | 3938Mi |
| c78a59a3-3907-4d2e-99df-5fc85560bd1d | agent-1  | default | 192.168.10.58  | linux/amd64 |   2 | 3938Mi |
+--------------------------------------+----------+---------+----------------+-------------+-----+--------+
```



æ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨ `kcctl create cluster` å‘½ä»¤åˆ›å»ºé›†ç¾¤äº†,å‘½ä»¤æ¨¡ç‰ˆå¦‚ä¸‹ï¼š

```bash
kcctl create cluster (--name CLUSTER_NAME) (--master NODES) [--worker NODES][ --untaint-master] 
```

> æ›´å¤šä¿¡æ¯è§ `kcctl create cluster -h`

åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°† agent1ã€2ã€3 ä½œä¸º master èŠ‚ç‚¹ï¼Œagent4ã€5ä½œä¸º worker èŠ‚ç‚¹ï¼Œå®Œæ•´å‘½ä»¤å¦‚ä¸‹ï¼š

```bash
kcctl create cluster --name demo --master 192.168.10.58,192.168.10.225,192.168.10.19 --worker 192.168.10.27,192.168.10.4
```



è¿™æ ·ä¸€ä¸ª 5 èŠ‚ç‚¹çš„é›†ç¾¤å¤§æ¦‚éœ€è¦ 5 åˆ†é’Ÿåˆ†é’Ÿå·¦å³å¯ä»¥å®Œæˆåˆ›å»º,ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹é›†ç¾¤çŠ¶æ€

```bash
kcctl get cluster -o yaml|grep status -A5
```

> æ‚¨ä¹Ÿå¯ä»¥è¿›å…¥æ§åˆ¶å°æŸ¥çœ‹å®æ—¶æ—¥å¿—ã€‚



è¿›å…¥ Running çŠ¶æ€å³è¡¨ç¤ºé›†ç¾¤å®‰è£…å®Œæˆ,æ‚¨å¯ä»¥ä½¿ç”¨ `kubectl get cs` å‘½ä»¤æ¥æŸ¥çœ‹é›†ç¾¤å¥åº·çŠ¶å†µã€‚

**ssh åˆ°ä»»æ„ master èŠ‚ç‚¹**ä¸ŠæŸ¥çœ‹é›†ç¾¤çŠ¶æ€ï¼š

```bash
[root@agent-1 ~]# kubectl get cs
Warning: v1 ComponentStatus is deprecated in v1.19+
NAME                 STATUS    MESSAGE                         ERROR
scheduler            Healthy   ok                              
controller-manager   Healthy   ok                              
etcd-0               Healthy   {"health":"true","reason":""} 
[root@agent-1 ~]# kubectl get node
NAME      STATUS   ROLES                  AGE     VERSION
agent-1   Ready    control-plane,master   6m41s   v1.23.6
agent-2   Ready    control-plane,master   6m5s    v1.23.6
agent-3   Ready    control-plane,master   6m14s   v1.23.6
agent-4   Ready    <none>                 5m17s   v1.23.6
agent-5   Ready    <none>                 5m18s   v1.23.6
```

å¯ä»¥çœ‹åˆ°ï¼Œ5 èŠ‚ç‚¹éƒ½å¤„äº Ready çŠ¶æ€ï¼Œè¯´æ˜é›†ç¾¤å®‰è£…æˆåŠŸã€‚



## 4. å°ç»“

æœ¬æ–‡æ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡ KubeClipper ä½¿ç”¨ç®€å•çš„å‘½ä»¤åˆ›å»º K8S é›†ç¾¤ã€‚

æ•´ä¸ªæµç¨‹å¯ä»¥ç®€å•çš„åˆ†ä¸º 3 ä¸ªæ­¥éª¤ï¼š

* 1ï¼‰å®‰è£… kcctl

```bash
curl -sfL https://oss.kubeclipper.io/kcctl.sh | KC_REGION=cn bash -
```

* 2ï¼‰ä½¿ç”¨ kcctl éƒ¨ç½² kubeclipper

```bash
kcctl deploy  [--user root] (--passwd SSH_PASSWD | --pk-file SSH_PRIVATE_KEY) (--server SERVER_NODES) (--agent AGENT_NODES)
```

* 3ï¼‰ä½¿ç”¨ kcctl æˆ–æ§åˆ¶å°åˆ›å»º K8S é›†ç¾¤

```bash
kcctl create cluster (--name CLUSTER_NAME) (--master NODES) [--worker NODES][ --untaint-master] 
```

æ–‡ä¸­æ‰€æœ‰æ“ä½œå‡é€šè¿‡å‘½ä»¤è¡Œå·¥å…·å®Œæˆï¼Œè‡³äºæ§åˆ¶å°ç›¸å…³åŠŸèƒ½åˆ™ç”±å¤§å®¶è‡ªè¡Œæ¢ç´¢äº†~



> å¦‚æœè§‰å¾—ä½“éªŒè¿˜ä¸é”™çš„è¯ï¼Œè¯·ä¸è¦åå•¬ä½ çš„ star ï¼Œ[KubeClipper](https://github.com/kubeclipper-labs) è¿˜å¤„äºå¿«é€Ÿæˆé•¿é˜¶æ®µï¼Œæ¬¢è¿å¤§å®¶ç§¯æå‚ä¸~